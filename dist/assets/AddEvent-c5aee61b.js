import{b as d,o as r,c,d as n,a as e,f as m,v as p,u as l,x as _,F as g,r as V,w as y,A as u}from"./index-d4651997.js";import{s as h}from"./calendar.esm-17eae640.js";import"./index.esm-335f96cf.js";import"./fileuploadstyle.esm-2cba6426.js";import{m as v}from"./index-062b750c.js";const $={class:""},z={class:"row overflow-hidden",style:{overflow:"hidden"}},F={class:"col-12 col-md-6"},U=e("label",{class:"fw-bold mb-1"}," Title ",-1),k={class:"col-12 col-md-6"},E=e("label",{class:"fw-bold mb-1"}," Description ",-1),L={class:"col-12 col-md-6"},S=e("label",{class:"fw-bold mb-1"}," Start date ",-1),D={class:"col-12 col-md-6"},A={class:"mb-3"},C=e("label",{class:"fw-bold mb-1"}," End date ",-1),B={class:"col-12 col-md-6"},T={class:"mb-3"},j=e("label",{class:"fw-bold mb-1"}," Add Venue ",-1),N=e("span",{class:"pe-point small"}," create new venue ",-1),O={class:"col-12 col-md-6"},M={class:"mb-3"},R=e("label",{class:"fw-bold mb-1"}," Select Timezone ",-1),q={class:"col-12 col-md-12"},H={class:"mb-3 d-flex flex-wrap"},I=e("div",{class:"fw-bold mb-1 w-100"},"Add files",-1),Z=e("br",null,null,-1),G={class:"fw-bold mb-1",for:"files"},J={class:"py-4 px-3 bg-primary rounded-7"},K={class:"p-1 me-2 position-relative rounded-7 overflow-hidden w-fit",style:{"max-width":"160px",height:"200px"}},P=["src"],Q=e("button",{class:"btn btn-primary mt-3 mb-4 p-2 w-100 w-lg-fit",type:"submit"}," Create Event ",-1),W={name:"HomeView",components:{},data(){const o=v.tz.names();return{event:{title:"",description:""},venue:{},files:[],zones:o}},methods:{getFormData(){const o=new FormData;return this.event.start=new Date(this.event.start).toLocaleString(),this.event.end=new Date(this.event.end).toLocaleString(),this.event.time_zone=v.tz(this.event.time_zone).zoneName(),o.append("title",this.event.title),o.append("description",this.event.description),o.append("start",this.event.start),o.append("end",this.event.end),o.append("venue_id",this.event.venue_id),o.append("time_zone",this.event.time_zone),this.files.forEach(t=>o.append("files[]",t)),o},async createEvent(){if(console.log(Object.keys(this.event).length),Object.keys(this.event).length<6||!this.files[0]){this.$toast.error("All fields are required");return}const o=this.getFormData();this.$widget.openLoading();const t=await this.$store.dispatch("createEventService",o);if(t.success){this.$toast.success("Event has been successfully created"),location.href="/event/"+t.data.id;return}this.$widget.dismiss(),this.$toast.error("Could not create event")},getUrl(o){return URL.createObjectURL(o)},updateFiles(){console.log(this.$refs.files.files);const o=Array.from(this.$refs.files.files).find(s=>!s.type.includes("image"));if(Array.from(this.$refs.files.files).find(s=>s.size>2097152)){this.$toast.error("File size must not exceed 2MB");return}if(o){this.$toast.error("File type must be image");return}this.files.push(...this.$refs.files.files)}},watch:{venue(o){this.event.venue_id=o.id}},created(){this.$store.dispatch("getVenueService")}},oe=Object.assign(W,{setup(o){return(t,s)=>{const f=d("te-header"),a=d("icon"),b=d("router-link");return r(),c("div",$,[n(f),e("form",{class:"p-3",onSubmit:s[7]||(s[7]=y((...i)=>t.createEvent&&t.createEvent(...i),["prevent"])),_style:"max-width:99vw;"},[e("div",z,[e("div",F,[e("div",null,[U,m(e("input",{placeholder:"Le ccusa",autocomplete:"","onUpdate:modelValue":s[0]||(s[0]=i=>t.event.title=i),class:"p-2 border rounded-7 w-100 mb-3"},null,512),[[p,t.event.title]])])]),e("div",k,[e("div",null,[E,m(e("textarea",{"onUpdate:modelValue":s[1]||(s[1]=i=>t.event.description=i),autocomplete:"",placeholder:"A description about the event",class:"p-2 border rounded-7 w-100 mb-3",style:{"min-height":"100px"}},null,512),[[p,t.event.description]])])]),e("div",L,[e("div",null,[S,n(l(h),{modelValue:t.event.start,"onUpdate:modelValue":s[2]||(s[2]=i=>t.event.start=i),placeholder:"starting period of the event","min-date":new Date,showTime:"",class:"mb-3 rounded-7 w-100"},null,8,["modelValue","min-date"])])]),e("div",D,[e("div",A,[C,n(l(h),{modelValue:t.event.end,"onUpdate:modelValue":s[3]||(s[3]=i=>t.event.end=i),placeholder:"end time of the event",showTime:"","min-date":t.event.start,class:"rounded-7 w-100"},null,8,["modelValue","min-date"])])]),e("div",B,[e("div",T,[j,n(l(u),{modelValue:t.venue,"onUpdate:modelValue":s[4]||(s[4]=i=>t.venue=i),options:t.$store.state.venues,optionLabel:"title",placeholder:"Select a Venue",class:"w-100 mb-1"},null,8,["modelValue","options"]),n(b,{class:"text-primary fw-bold pe-point w-fit",to:"/venue/add"},{default:_(()=>[n(a,{icon:"solar:home-add-broken",class:"my-auto"}),N]),_:1})])]),e("div",O,[e("div",M,[R,n(l(u),{modelValue:t.event.time_zone,"onUpdate:modelValue":s[5]||(s[5]=i=>t.event.time_zone=i),options:t.zones,filter:"",optionLabel:"",placeholder:"Select a TimeZone",class:"w-100 mb-1"},null,8,["modelValue","options"])])]),e("div",q,[e("div",H,[I,Z,e("label",G,[e("div",J,[n(a,{icon:"mingcute:add-fill",class:"fs-1 text-white"})])]),(r(!0),c(g,null,V(t.files,(i,w)=>(r(),c("div",K,[e("img",{class:"w-100 rounded-7 object-fit-cover",src:t.getUrl(i)},null,8,P),n(a,{icon:"icons8:cancel",class:"fs-2 pe-point text-danger position-absolute top-0 start-0",onClick:X=>t.files.splice(w,1)},null,8,["onClick"])]))),256)),e("input",{type:"file",multiple:"",ref:"files",accept:"image/*",id:"files",hidden:"",onChange:s[6]||(s[6]=(...i)=>t.updateFiles&&t.updateFiles(...i))},null,544)])])]),Q],32)])}}});export{oe as default};
